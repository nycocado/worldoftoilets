services:
    api:
        build:
            context: ./apps/api
            dockerfile: Dockerfile.dev
        container_name: wot-api
        restart: unless-stopped
        environment:
            DATABASE_PORT: ${MARIADB_MAXSCALE_RW_PORT}
            DATABASE_USER: ${MARIADB_USER}
            DATABASE_PASSWORD: ${MARIADB_PASSWORD}
            DATABASE_NAME: ${MARIADB_DATABASE}
            JWT_SECRET: ${JWT_SECRET}
            JWT_EXPIRATION: ${JWT_EXPIRATION}
            NODE_ENV: development
            PORT: ${API_INTERNAL_PORT}
            WATCHPACK_POLLING: "true"
            CHOKIDAR_USEPOLLING: "true"
        volumes:
            - ./apps/api:/app
            - ./apps/api/storage:/app/storage
            - /app/node_modules
        networks:
            - wot-network

networks:
    wot-network:
        name: wot-network
        driver: bridge
